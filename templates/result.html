<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Personalized Diet Plan</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <header>
    <h1>ğŸ Your Personalized Diet Plan</h1>
    <p>Based on your preferences and health goals</p>
  </header>

  <main>
    <div class="result-card">
      <h2>Daily Calorie Requirement</h2>
      <p class="highlight">{{ calories }} kcal</p>

      <h3>Goal: <span>{{ goal }}</span></h3>
      <h3>Food Preference: <span>{{ preference }}</span></h3>

      <h2>Recommended Meals</h2>
      <div id="mealList" class="meal-list">
        {% for meal in meals %}
        <div class="meal-item">
          <span class="meal-emoji">ğŸ½ï¸</span>
          <div>
            <p class="dish-name">{{ meal['Dish Name'] }}</p>
            <p class="nutri-info">
              ğŸ {{ meal['Calories (kcal)'] }} kcal |
              ğŸ¥© {{ meal['Protein (g)'] }} g protein |
              ğŸš {{ meal['Carbohydrates (g)'] }} g carbs |
              ğŸ§ˆ {{ meal['Fats (g)'] }} g fat
            </p>
          </div>
        </div>
        {% endfor %}
      </div>

      <button id="moreBtn" class="back-btn">ğŸ”„ Show More Options</button>
      <a href="/" class="back-btn">â† Go Back</a>
    </div>
  </main>

  <footer>
    <p>Made with â¤ï¸ by Atharva & Team | PCCOE AIML</p>
  </footer>

  <!-- JavaScript for Show More feature -->
  <script>
    const moreBtn = document.getElementById('moreBtn');
    moreBtn.addEventListener('click', async () => {
      const res = await fetch('/more_meals', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: `goal={{ goal }}&preference={{ preference }}`
      });
      const meals = await res.json();

      const mealList = document.getElementById('mealList');
      mealList.innerHTML = meals.map(m => `
        <div class="meal-item">
          <span class="meal-emoji">ğŸ½ï¸</span>
          <div>
            <p class="dish-name">${m['Dish Name']}</p>
            <p class="nutri-info">
              ğŸ ${m['Calories (kcal)']} kcal |
              ğŸ¥© ${m['Protein (g)']} g protein |
              ğŸš ${m['Carbohydrates (g)']} g carbs |
              ğŸ§ˆ ${m['Fats (g)']} g fat
            </p>
          </div>
        </div>
      `).join('');
    });
  </script>
</body>
</html>
